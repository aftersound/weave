{
    "openapi": "3.1.0",
    "info": {
        "title": "Greeting Services",
        "description": "Demonstrate declarative services and basic extensions points",
        "contact": {
            "email": "aftersound@gmail.com"
        },
        "version": "1.0.0"
    },
    "paths": {
        "/greet/{name}": {
            "get": {
                "summary": "greet a person or entity by name",
                "description": "Greet service without auth and rate limit",
                "operationId": "greet",
                "parameters": [
                    {
                        "name": "name",
                        "in": "path",
                        "description": "the name of person or entity to greet",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "greeting happens",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Greeting"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "internal error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Messages"
                                }
                            }
                        }
                    }
                },
                "extensions": {
                    "x-weave-execution-control": {
                        "type": "GreetingService",
                        "greetingWords": [
                            "Hello",
                            "Hola",
                            "您好"
                        ]
                    }
                }
            }
        },
        "/greet1/{name}": {
            "get": {
                "summary": "greet a person or entity by name",
                "description": "Greet service with auth but without rate limit",
                "operationId": "greet",
                "parameters": [
                    {
                        "name": "name",
                        "in": "path",
                        "description": "the name of person or entity to greet",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "greeting happens",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Greeting"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "internal error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Messages"
                                }
                            }
                        }
                    }
                },
                "extensions": {
                    "x-weave-auth-control": {
                        "type": "Demo",
                        "userCredentials": {
                            "user": "W6ph5Mm5Pz8GgiULbPgzG37mj9g="
                        }
                    },
                    "x-weave-execution-control": {
                        "type": "GreetingService",
                        "greetingWords": [
                            "Hello",
                            "Hola",
                            "您好"
                        ]
                    }
                }
            }
        },
        "/greet2/{name}": {
            "get": {
                "summary": "greet a person or entity by name",
                "description": "Greet service without auth but with rate limit",
                "operationId": "greet",
                "parameters": [
                    {
                        "name": "name",
                        "in": "path",
                        "description": "the name of person or entity to greet",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "greeting happens",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Greeting"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "internal error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Messages"
                                }
                            }
                        }
                    }
                },
                "extensions": {
                    "x-weave-rate-limit-control": {
                        "type": "Demo"
                    },
                    "x-weave-execution-control": {
                        "type": "GreetingService",
                        "greetingWords": [
                            "Hello",
                            "Hola",
                            "您好"
                        ]
                    }
                }
            }
        },
        "/greet3/{name}": {
            "get": {
                "summary": "greet a person or entity by name",
                "description": "Greet service with both auth and rate limit",
                "operationId": "greet",
                "parameters": [
                    {
                        "name": "name",
                        "in": "path",
                        "description": "the name of person or entity to greet",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "greeting happens",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Greeting"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "internal error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Messages"
                                }
                            }
                        }
                    }
                },
                "extensions": {
                    "x-weave-auth-control": {
                        "type": "Demo",
                        "userCredentials": {
                            "user": "W6ph5Mm5Pz8GgiULbPgzG37mj9g="
                        }
                    },
                    "x-weave-rate-limit-control": {
                        "type": "Demo"
                    },
                    "x-weave-execution-control": {
                        "type": "GreetingService",
                        "greetingWords": [
                            "Hello",
                            "Hola",
                            "您好"
                        ]
                    }
                }
            }
        }
    },
    "components": {
        "schemas": {
            "Greeting": {
                "type": "object",
                "properties": {
                    "greeting": {
                        "type": "string",
                        "example": "Hello, Weave"
                    }
                }
            },
            "Messages": {
                "type": "object",
                "properties": {
                    "messages": {
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/Message"
                        }
                    }
                }
            },
            "Message": {
                "required": [
                    "id",
                    "owner",
                    "ownerEmail"
                ],
                "type": "object",
                "properties": {
                    "id": {
                        "type": "integer",
                        "format": "int64"
                    },
                    "severity": {
                        "type": "string",
                        "enum": [
                            "Error",
                            "Warning"
                        ]
                    },
                    "category": {
                        "type": "string",
                        "enum": [
                            "System",
                            "Application",
                            "Service",
                            "Request"
                        ]
                    },
                    "message": {
                        "type": "string"
                    }
                }
            }
        }
    },
    "extensions": {
        "x-weave-extensions": [
            {
                "group": "COMPONENT_FACTORY",
                "baseType": "io.aftersound.weave.component.ComponentFactory",
                "types": []
            },
            {
                "group": "VALUE_FUNC_FACTORY",
                "baseType": "io.aftersound.weave.common.ValueFuncFactory",
                "types": [
                    "io.aftersound.weave.service.request.ParamValueFuncFactory",
                    "io.aftersound.weave.value.CommonValueFuncFactory"
                ]
            },
            {
                "group": "AUTH_HANDLER",
                "baseType": "io.aftersound.weave.service.security.AuthHandler",
                "types": [
                    "io.aftersound.weave.sample.extension.service.security.DemoAuthHandler"
                ]
            },
            {
                "group": "RATE_LIMIT_EVALUATOR",
                "baseType": "io.aftersound.weave.service.rl.RateLimitEvaluator",
                "types": [
                    "io.aftersound.weave.sample.extension.service.rl.DemoRateLimitEvaluator"
                ]
            },
            {
                "group": "SERVICE_EXECUTOR",
                "baseType": "io.aftersound.weave.service.ServiceExecutor",
                "types": [
                    "io.aftersound.weave.sample.extension.service.GreetingServiceExecutor"
                ]
            }
        ],
        "x-weave-components": []
    }
}